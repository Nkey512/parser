Я изначально декомпозировал код на функции, однако не создал класс, который бы инкапсулировал логику работы.
В связи с этим основная часть программы осталась похожей на «спагетти/процедурный» стиль.
